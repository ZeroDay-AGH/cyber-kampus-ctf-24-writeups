Do faktoryzacji liczby $N$ użyliśmy metody Fermata. Jest to skuteczna technika w przypadku, gdy liczba $N$ jest iloczynem dwóch dużych liczb pierwszych $p$ i $q$, które są do siebie zbliżone. Metoda polega na znalezieniu liczb $a$ i $b$, takich że:

$$ N = a^2 - b^2 $$

bo wtedy:

$$ N = (a-b) \cdot (a+b) = p \cdot q $$

Aby znaleźć takie liczby $a$ i $b$, iteracyjnie zwiększamy $a$ od wartości $\lceil\sqrt{N}\rceil$ i sprawdzamy, czy $a^2 - N$ jest kwadratem liczby całkowitej:

$$  a^2 - N = b^2 $$

```python
from Crypto.Util.number import long_to_bytes

def isqrt(n):
    x = n
    y = (x + n // x) // 2
    while y < x:
        x = y
        y = (x + n // x) // 2
    return x

def fermat(n):
    t0 = isqrt(n) + 1
    counter = 0
    t = t0 + counter
    temp = isqrt((t * t) - n)
    while (temp * temp) != ((t * t) - n):
        counter += 1
        t = t0 + counter
        temp = isqrt((t * t) - n)
    s = temp
    p = t + s
    q = t - s
    return p, q

N = 30122325932082343921367976964416197501547040591451180064469069804608845956199774903916842614580266819952320547490860228728767239246063773512766014217000240405220544571163406204223069324156652725373616792350438658733490404263252183785021521435299217422008246958717724352182966255716558043503472272949898102300285959985539478127021232071172776616716166765255864627245729832893095901286270661847483304336055667026030096781627272235423554786879284375939728581350757990563032169796435000518146989019716109172101728330586587241538720269658803455860657728709663720455100523102904040881162104564898112172647256677187406472529
e = 65537
ct = 4606029007185058098585237041968601931373563872563133500128027363933785010618922110790748135879228300776881971874433104866655849886146906679929230747041176115976140161319725500972971914074684892435439166302346646935662409923625327334667652108922663387453925022824927733242546538717680861913779757178471544647085348609506666840694864993246402094991602972311182718894145520951776543871860656085901401076329767390228271739534877446081184945091575012847377903113809605351716309218610044462487450900339500070452577249582534841954559351085791978771037620682650332076390226353287199895766703249864943395514561986342287848062

p,q = fermat(N)
tot = (p-1)*(q-1)
d = pow(e,-1,tot)

m = pow(ct,d,N)
print(long_to_bytes(m).decode())
```
